<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<title>צעצועים</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;margin:0;background:#f8fafc}
header{
  background:#fff;
  padding:14px;
  display:flex;
  justify-content:space-between;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
}
header a{text-decoration:none;font-weight:bold;color:#f97316}
.filters{padding:12px;background:#fff}
select{padding:10px;border-radius:10px;margin-left:8px}
.grid{
  padding:16px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:16px;
}
.card{
  background:#fff;
  border-radius:22px;
  overflow:hidden;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
  transition:.2s;
}
.card:active{transform:scale(.97)}
.card img{width:100%;height:200px;object-fit:cover}
.card-body{padding:14px}
.price{color:#16a34a;font-size:20px;font-weight:bold}
.btn{
  display:block;
  margin-top:10px;
  padding:12px;
  background:#f97316;
  color:#fff;
  text-align:center;
  border-radius:14px;
  text-decoration:none;
}
</style>
</head>
<body>

<header>
  <a href="home.html">⬅ חזרה</a>
  <a href="add.html">➕ פרסום</a>
</header>

<div class="filters">
  <select id="cityFilter" onchange="loadToys()">
    <option value="">כל הערים</option>
  </select>
</div>

<div class="grid" id="list">טוען…</div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const supabaseClient=supabase.createClient(
  'https://zdawqdjmxtpgziggwjxa.supabase.co',
  'YOUR_ANON_KEY'
);

async function loadToys(){
  const city=cityFilter.value;
  let q=supabaseClient.from('toys').select('*').eq('status','approved');
  if(city) q=q.eq('city',city);

  const {data}=await q;
  list.innerHTML='';
  const cities=new Set();

  data.forEach(t=>{
    cities.add(t.city);
    const img=t.image_url||'https://via.placeholder.com/400x300?text=Toy';
    list.innerHTML+=`
      <div class="card">
        <img src="${img}">
        <div class="card-body">
          <b>${t.name}</b>
          <div class="price">₪${t.price}</div>
          ${t.city}
          <a class="btn" href="toy.html?id=${t.id}">לצפייה</a>
        </div>
      </div>`;
  });

  cityFilter.innerHTML='<option value="">כל הערים</option>';
  cities.forEach(c=>cityFilter.innerHTML+=`<option>${c}</option>`);
}
loadToys();
</script>

</body>
</html>
